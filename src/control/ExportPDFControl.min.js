'use strict';ol.control.MeasureControl=function(a){var g=arguments,b=a||{},c=this,d=document.createElement('button');c.type=b.type||'LineString';var e=document.createElement('span');e.className='icon-measure',d.appendChild(e);var f=!1;c.ohelpTooltip=[],c.omeasureTooltip=[],d.addEventListener('click',function(){f?c.clear.apply(c,g):c.drawStart.apply(c,g),f=!f},!1);var h=document.createElement('div');h.className='ol-measure ol-unselectable ol-control',h.appendChild(d),h.setAttribute('data-toggle','tooltip'),h.setAttribute('title',a.tooltip||'Mierzenie'),ol.control.Control.call(c,{element:h,target:b.target}),c.source=new ol.source.Vector,c.vector=new ol.layer.Vector({source:c.source,style:new ol.style.Style({fill:new ol.style.Fill({color:'rgba(255, 255, 255, 0.2)'}),stroke:new ol.style.Stroke({color:'#ffcc33',width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:'#ffcc33'})})})}),c.sketch;var i=a.continuePolygonMsg||'Kliknij, aby kontynuowa\u0107 rysowanie wielok\u0105ta',j=a.continueLineMsg||'Kliknij, aby kontynuowa\u0107 rysowanie linii';c.pointerMoveHandler=function(l){if(f&&!l.dragging){var m=a.helpMsg||'Kliknij, aby rozpocz\u0105\u0107 rysowanie';if(c.sketch){var n=c.sketch.getGeometry();n instanceof ol.geom.Polygon?m=i:n instanceof ol.geom.LineString&&(m=j)}c.ohelpTooltip[c.ohelpTooltip.length-1].get('element').innerHTML=m,c.ohelpTooltip[c.ohelpTooltip.length-1].setPosition(l.coordinate),c.ohelpTooltip[c.ohelpTooltip.length-1].get('element').classList.remove('hidden')}},c.draw=new ol.interaction.Draw({source:c.source,type:c.type,style:new ol.style.Style({fill:new ol.style.Fill({color:'rgba(255, 255, 255, 0.2)'}),stroke:new ol.style.Stroke({color:'rgba(0, 0, 0, 0.5)',lineDash:[10,10],width:2}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:'rgba(0, 0, 0, 0.7)'}),fill:new ol.style.Fill({color:'rgba(255, 255, 255, 0.2)'})})})});var k;c.draw.on('drawstart',function(l){c.sketch=l.feature;var m=l.coordinate;k=c.sketch.getGeometry().on('change',function(n){var o=n.target,p;o instanceof ol.geom.Polygon?(p=ol.control.MeasureControl.formatArea(o),m=o.getInteriorPoint().getCoordinates()):o instanceof ol.geom.LineString&&(p=ol.control.MeasureControl.formatLength(o),m=o.getLastCoordinate()),c.omeasureTooltip[c.omeasureTooltip.length-1].get('element').innerHTML=p,c.omeasureTooltip[c.omeasureTooltip.length-1].setPosition(m)},c)},c),c.draw.on('drawend',function(){c.omeasureTooltip[c.omeasureTooltip.length-1].get('element').className='ol-measure-tooltip ol-measure-tooltip-static',c.omeasureTooltip[c.omeasureTooltip.length-1].setOffset([0,-7]),c.sketch=null,c.createMeasureTooltip(),ol.Observable.unByKey(k)},c)},ol.inherits(ol.control.MeasureControl,ol.control.Control),ol.control.MeasureControl.prototype.setMap=function(a){var b=this;ol.control.Control.prototype.setMap.call(b,a),a&&(a.addLayer(b.vector),a.on('pointermove',b.pointerMoveHandler,b),a.getViewport().addEventListener('mouseout',function(){b.ohelpTooltip&&0<b.ohelpTooltip.length&&b.ohelpTooltip[b.ohelpTooltip.length-1].get('element').classList.add('hidden')}))},ol.control.MeasureControl.prototype.createHelpTooltip=function(){var a=document.createElement('div');a.className='ol-measure-tooltip hidden';var b=new ol.Overlay({element:a,offset:[15,0],positioning:'center-left'});this.ohelpTooltip.push(b),this.getMap().addOverlay(b)},ol.control.MeasureControl.prototype.createMeasureTooltip=function(){var a=document.createElement('div');a.className='ol-measure-tooltip ol-measure-tooltip-measure';var b=new ol.Overlay({element:a,offset:[0,-15],positioning:'bottom-center'});this.omeasureTooltip.push(b),this.getMap().addOverlay(b)},ol.control.MeasureControl.prototype.clear=function(){var a=this;a.omeasureTooltip.forEach(function(b){return a.getMap().removeOverlay(b)}),a.ohelpTooltip.forEach(function(b){return a.getMap().removeOverlay(b)}),a.omeasureTooltip=[],a.ohelpTooltip=[],a.source.clear(),a.getMap().removeInteraction(a.draw)},ol.control.MeasureControl.prototype.drawStart=function(){this.createMeasureTooltip(),this.createHelpTooltip(),this.getMap().addInteraction(this.draw)},ol.control.MeasureControl.formatLength=function(a){var c,b=ol.Sphere.getLength(a);return c=100<b?Math.round(100*(b/1e3))/100+' km':Math.round(100*b)/100+' m',c},ol.control.MeasureControl.formatArea=function(a){var c,b=ol.Sphere.getArea(a);return c=1e4<b?Math.round(100*(b/1e6))/100+' km<sup>2</sup>':Math.round(100*b)/100+' m<sup>2</sup>',c};